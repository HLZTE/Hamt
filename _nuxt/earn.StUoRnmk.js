import{a0 as O,m as t,O as e,V as T,u as n,i as d,a1 as A,n as U,p as E,a2 as l,S as R,J as o}from"./entry.DvOc7D6n.js";const h=O("earn",{state:()=>({tasks:[],dailyRewardInterval:null,dailyRewardSeconds:0,timestamp_daily_reward:0}),actions:{getEarnName(a){switch(a){case e.SUBSCRIBE_TELEGRAM_CHANNEL:return t().$i18n.t("earn.subscribe_telegram_channel");case e.SUBSCRIBE_TELEGRAM_GROUP:return t().$i18n.t("earn.subscribe_telegram_group");case e.INVITE_FRIENDS:return t().$i18n.t("earn.invite_friends",{n:3});case e.PIN_BOT:return t().$i18n.t("earn.pin_bot");case e.GLEAM_TASKS:return t().$i18n.t("earn.gleam");case e.SUBSCRIBE_X_ACCOUNT:return t().$i18n.t("earn.x");case e.SUBSCRIBE_FACEBOOK:return t().$i18n.t("earn.subscribe_facebook");case e.STREAK_DAYS:return t().$i18n.t("earn.daily_reward");case e.SELECT_EXCHANGE:return t().$i18n.t("earn.select_exchange");case e.EXCHANGE_SIGNUP_VIA_FRIEND_LINK:return t().$i18n.t("bingx.example_text",{name:n().composeTelegramName(d().referrer??{})});case e.SUBSCRIBE_MEDIUM:return t().$i18n.t("earn.subscribe_medium");case e.SUBSCRIBE_DISCORD:return t().$i18n.t("earn.subscribe_discord");case e.SUBSCRIBE_YOUTUBE_CHANNEL:return t().$i18n.t("earn.subscribe_youtube_channel");case e.ADD_OUR_BOT:return t().$i18n.t("earn.add_our_bot",{bot_name:T.GAME_NAME});case e.HAMSTER_DROP:return t().$i18n.t("earn.hamster_drop",{game:T.GAME_NAME});case e.SUBSCRIBE_TELEGRAM_CRYPTOFAM:case e.HAMSTER_YOUTUBE_ACADEMY:case e.HAMSTER_YOUTUBE_EASY_START:case e.HAMSTER_YOUTUBE_LOCAL_SUBSCRIBE:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E5:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E6:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E7:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E8:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E9:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E10:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E11:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E12:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E13:case e.HAMSTER_YOUTUBE_LOCAL_VIDEO_E14:case e.HAMSTER_YOUTUBE_EASY_START_S1E23:case e.HAMSTER_YOUTUBE_EASY_START_S1E24:case e.HAMSTER_YOUTUBE_EASY_START_S1E25:case e.HAMSTER_YOUTUBE_EASY_START_S1E26:case e.HAMSTER_YOUTUBE_EASY_START_S1E27:case e.HAMSTER_YOUTUBE_EASY_START_S1E28:case e.HAMSTER_YOUTUBE_EASY_START_S1E29:case e.HAMSTER_YOUTUBE_PARTNER_VIDEO_E1:return t().$i18n.t(`earn.${a}`);default:return t().$i18n.t("earn.title")}},async postListTasks(){return await A.post("/clicker/list-tasks",{}).then(a=>(a!=null&&a.tasks&&this.setTasks(a.tasks),this.startDailyRewardInterval(),a)).catch(a=>{U.error({title:t().$i18n.t("messages.request_error"),message:t().$i18n.t("messages.no_tasks")})})},async postCheckTask(a){return await A.post("/clicker/check-task",{body:{taskId:a}}).then(r=>{E().useHapticFeedback("heavy"),d().setUserResponseData(r),setTimeout(()=>{l().postUpgradesForBuy()},1e3);const _=r.task.rewardCoins??0;return n().trackEvent(`earn_${n().camelToSnake(a)}`,{value:_}),r})},setTasks(a=[]){var S;const r=t(),{locale:_}=r.$i18n;if(a.length){a.find(s=>s.id===e.SUBSCRIBE_FACEBOOK)&&["fr","de"].indexOf(E().language_code)>-1||(a=a.filter(s=>s.id!==e.SUBSCRIBE_FACEBOOK)),a.find(s=>s.id===e.SUBSCRIBE_TELEGRAM_CRYPTOFAM)&&(["fr","de"].indexOf(E().language_code)||["fr","de"].indexOf(_.value))>-1||(a=a.filter(s=>s.id!==e.SUBSCRIBE_TELEGRAM_CRYPTOFAM)),a.find(s=>s.id===e.HAMSTER_YOUTUBE_PARTNER_VIDEO_E1)&&(["en","de","es","id","hi","fr","ar","pt","zh","ko","ja","it"].indexOf(E().language_code)>-1||["en","de","es","id","hi","fr","pt"].indexOf(_.value)>-1)||(a=a.filter(s=>s.id!==e.HAMSTER_YOUTUBE_PARTNER_VIDEO_E1));const i=localStorage.getItem(R.EARN_TASKS),c=a.map(s=>s.id===e.STREAK_DAYS?{...s,remainSeconds:0}:s);i?this.hashcode(c)!==Number(i)&&(E().taskNotification=!0):E().taskNotification=!0,this.tasks=a,localStorage.setItem(R.EARN_TASKS,JSON.stringify(this.hashcode(c))),this.dailyRewardSeconds=((S=this.tasks.find(s=>s.id===e.STREAK_DAYS))==null?void 0:S.remainSeconds)??Math.round(n().secondsUntilMidnightUTC()),this.startDailyRewardInterval()}},hashcode(a){let r=0;const _=JSON.stringify(a).replace(/\{|\"|\}|\:|,/g,""),S=_.length;for(let i=0;i<S;i++)r+=_.charCodeAt(i)*7;return r},resetDailyRewardInterval(){this.dailyRewardInterval&&clearInterval(this.dailyRewardInterval),this.dailyRewardInterval=null},startDailyRewardInterval(){this.resetDailyRewardInterval(),this.dailyRewardInterval=o(()=>{if(this.dailyRewardSeconds){let a=1;const r=n().getNowTimestamp();this.timestamp_daily_reward&&r-this.timestamp_daily_reward>1&&(a=r-this.timestamp_daily_reward),this.dailyRewardSeconds-=a,this.dailyRewardSeconds<=0&&(this.dailyRewardSeconds=0,this.resetDailyRewardInterval(),setTimeout(async()=>{await this.postListTasks().then(()=>{})},1e3)),this.timestamp_daily_reward=r}},1e3)}}});export{h as u};
